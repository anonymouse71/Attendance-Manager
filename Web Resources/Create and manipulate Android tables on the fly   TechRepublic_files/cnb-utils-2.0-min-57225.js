Native.implement([Element,Window,Document,Events],{addOneEvent:function(a,b){return this.addEvent(a,function(){this.removeEvent(a,arguments.callee);return b.apply(this,arguments)})}});String.implement({parseQueryString:function(){var e=this.split(/[&;]/),res={};if(e.length)e.each(function(c){var d=c.indexOf('='),keys=d<0?['']:c.substr(0,d).match(/[^\]\[]+/g),value=decodeURIComponent(c.substr(d+1)),obj=res;keys.each(function(a,i){var b=obj[a];if(i<keys.length-1)obj=obj[a]=b||{};else if($type(b)=='array')b.push(value);else obj[a]=$defined(b)?[b,value]:value})});return res}});Element.implement({toJSON:function(){var d={};this.getElements('input, select, textarea',true).each(function(b){if(!b.name||b.disabled||b.type=='submit'||b.type=='reset'||b.type=='file')return;var c=(b.tagName.toLowerCase()=='select')?Element.getSelected(b).map(function(a){return a.value}):((b.type=='radio'||b.type=='checkbox')&&!b.checked)?null:b.value;$splat(c).each(function(a){if(typeof a!='undefined'){if(typeof d[b.name]!='undefined'){if($type(d[b.name])=='array'){d[b.name].push(a)}else{d[b.name]=[d[b.name],a]}}else{d[b.name]=a}}})});return d}});Elements.from=function(a,b){if(b||b===null)a=a.stripScripts();var c,match=a.match(/^\s*<(t[dhr]|tbody|tfoot|thead)/i);if(match){c=new Element('table');var d=match[1].toLowerCase();if(['td','th','tr'].contains(d)){c=new Element('tbody').inject(c);if(d!='tr')c=new Element('tr').inject(c)}}return(c||new Element('div')).set('html',a).getChildren()};var CNB={};CNB.log=function(){if(window.console&&console.log){try{console.log.apply(console,arguments)}catch(e){console.log(Array.slice(arguments))}}};CNB.htmlToElement=function(a,b){if($type(a)=='string'){a=new Element('div',{'html':a});if(b===false){a=a.getChildren()}}return a};CNB.scrollTo=function(a){var b=$(a);if(b!==null){var c=new Fx.Scroll(window).toElement(b)}};CNB.getCookieHost=function(){var a=location.hostname.match("([^\.]*?)\.(com|net|org|co\.uk|com\.au|co\.cn)$");if($chk(a)){return'.'+a[0]}else{return location.hostname}};CNB._hasCookiesEnabled=null;CNB.hasCookiesEnabled=function(){if(CNB._hasCookiesEnabled===null){Cookie.write('cookies-enabled','enabled');if(Cookie.read('cookies-enabled')!==null){Cookie.dispose('cookies-enabled');CNB._hasCookiesEnabled=true}else{CNB._hasCookiesEnabled=false}}return CNB._hasCookiesEnabled};(function(){CNB.isTouchDevice=null;try{document.createEvent("TouchEvent");CNB.isTouchDevice=true}catch(e){CNB.isTouchDevice=false}})();CNB.User=new Hash({'regId':null,'isLoggedIn':false,'geoDomain':null});CNB.Page=new Hash({'siteId':null,'nodeId':null,'ncat':null,'assetId':null,'pageType':null,'editionId':null,'brandId':null,'guid':null,'userIP':null});CNB.Overlay=new Class({Implements:[Options,Events],options:{id:'overlay',containerClass:'contain-overlay-12',retainContent:false,content:null,contentId:null},initialize:function(e){this.setOptions(e);this.shell=new Element('div',{'id':this.options.id,'class':'overlay-shell','styles':{'display':'none'}});this.overlay=new Element('div',{'class':'overlay'}).inject(this.shell);this.interior=new Element('div',{'class':'overlay-int'}).inject(this.overlay);var f=new Element('a',{'class':'overlay-close','text':'close','events':{'click':this.close.bind(this)}}).inject(this.interior);this.contentContainer=new Element('div',{'class':'overlay-content clear'}).inject(this.interior);this.containerClass='';this.setContainerClass();this.addEvent('contentReady',function(b){b.getElements('.close').each(function(a){a.addEvent('click',this.close.bind(this))}.bind(this));var c=b.getElements('*[placeholder]');if(c.length>0){var d=new CNB.Placeholder(c)}}.bind(this));this.addEvent('open',function(){window.addEvent('keydown',this.keyEvents.bind(this))}.bind(this));this.addEvent('close',function(){window.removeEvent('keydown',this.keyEvents)}.bind(this));window.addEvent('domready',function(){this.shell.inject($(document.body))}.bind(this))},open:function(a){if($chk(a))this.setOptions(a);window.addEvent('domready',function(){this.fireEvent('open');this.setContainerClass();this.setContent();this.position();this.shell.setStyle('display','block');this.fireEvent('openComplete')}.bind(this));return this},close:function(){this.fireEvent('close');this.shell.setStyle('display','none')},remove:function(){this.fireEvent('remove');this.shell.dispose()},notify:function(a,b){if(!$chk(a)){CNB.log('No notification received for overlay.');return false}var c=new Element('div',{'class':'notify','html':a});this.addOneEvent('openComplete',function(){this.closeDelay=this.close.delay(2500,this);this.addOneEvent('close',function(){$clear(this.closeDelay)}.bind(this))}.bind(this));this.open($merge(b,{'content':c,'containerClass':'contain-overlay-12'}))},setContent:function(a){if($chk(a))this.setOptions(a);this.fireEvent('setContent');if($chk(this.options.content)){this._setHtml(this.options.content)}else if($chk(this.options.contentId)){this._getHtml(this.options.contentId)}this.setOptions({'content':null,'contentId':null})},position:function(){var a=Math.floor(window.getSize().y/6);var b=window.getScroll().y;this.overlay.setStyle('margin-top',a+b);this.shell.setStyle('height',window.getScrollSize().y)},setContainerClass:function(){if($chk(this.containerClass))this.overlay.removeClass(this.containerClass);this.overlay.addClass(this.options.containerClass);this.containerClass=this.options.containerClass},keyEvents:function(a){if(a.key=='esc')this.close()},_setHtml:function(a){if(this.contentContainer.getChildren().length>0)this.contentContainer.empty();if(!$chk(a)){CNB.log('No content received for overlay.');return false}if($type(a)=='string'){a=new Element('div',{'html':a})}a.inject(this.contentContainer);this.fireEvent('contentReady',a)},_getHtml:function(a){var b=$(a).get('html');this._setHtml(b)}});CNB.Overlay.Async=new Class({Extends:CNB.Overlay,options:{url:'',data:''},initialize:function(a){this.parent(a);this.loader=new CNB.Loading(this.contentContainer);this.addEvent('setContent',this.makeRequest.bind(this))},makeRequest:function(){if(!$chk(this.options.url))return false;this.loader.add();var e=new Request.HTML({url:this.options.url,data:this.options.data,onSuccess:function(a,b,c,d){this._setHtml(c)}.bind(this),onComplete:this.loader.remove.bind(this.loader),onFailure:function(a){CNB.log('request - failure');this._setHtml('<div class="notify">Oops. Something went wrong.</div>')}.bind(this)}).get();this.setOptions({'url':'','data':''})}});CNB.Overlay.load=function(a){var b;if($chk(a.url)){b=new CNB.Overlay.Async(a).open();return false}else if(a.contentId!==null||a.content!==null){b=new CNB.Overlay(a).open();return false}b=new CNB.Overlay(a).notify('Sorry. That content could not be loaded.')};CNB.Loading=new Class({Implements:Options,options:{'className':'loading','opacity':'0','float':'none'},initialize:function(a,b){this.setOptions(b);this.contentContainer=$(a);this.loadingContainer=new Element('div',{'class':'loading-container','styles':{'float':this.options.float,'display':this.contentContainer.getStyle('display')}}).wraps(this.contentContainer)},add:function(){this.loadingContainer.addClass(this.options.className);this.contentContainer.setStyle('opacity',this.options.opacity)},remove:function(){this.loadingContainer.removeClass(this.options.className);this.contentContainer.setStyle('opacity','1');this.contentContainer.removeProperty('style')}});CNB.Loader=new Class({Implements:Options,options:{containerClassName:'',loaderClassName:'view-loading',opacity:'.5',position:'center',offset:{x:0,y:0},text:'Loading...',minHeight:0},initialize:function(a,b){this.setOptions(b);this.container=$(a);this.loader=new Element('div',{'class':this.options.loaderClassName,'text':this.options.text,'styles':{'position':'absolute','left':'-9999px','z-index':this.formatZindexFromEl(this.container)}}).inject(this.container,'after');this.container.store('loader',this)},add:function(){this.container.addClass(this.options.containerClassName);this.container.setStyles({'opacity':this.options.opacity,'min-height':this.options.minHeight});this.loader.position({relativeTo:this.container,position:this.options.position,edge:this.options.position,offset:this.options.offset})},remove:function(){this.container.removeClass(this.options.containerClassName);this.container.setStyles({'opacity':'1','min-height':'auto'});this.container.removeProperty('style');this.loader.setStyle('left','-9999px')},formatZindexFromEl:function(a){var b=a.getStyle('z-index');if($type(b.toInt())=='number'){return b.toInt()+1}else{return 1}}});CNB.Selector=new Class({Implements:[Options,Events],options:{cookieName:null,startSeq:0,hiddenClass:'hide'},initialize:function(a,b,c){this.setOptions(c);this.tabs=$splat(a);this.contents=$splat(b);this.seq=this.options.startSeq;if(this.options.cookieName!==null){var d=Cookie.read(this.options.cookieName);if(parseInt(d)<this.tabs.length){this.seq=d}}},load:function(){if((this.tabs.length===0)||(this.contents.length===0))return false;this.tabs.each(function(a,i){if(!a.hasClass('external')){a.addEvent('click',function(e){e.stop();this.open(i)}.bind(this));this.close(i)}},this);this.open(this.seq);this.addEvent('open',function(){this.close(this.seq)}.bind(this));return this},open:function(i){this.fireEvent('open',i);this.tabs[i].addClass('on');this.contents[i].removeClass(this.options.hiddenClass);this.seq=i;if(this.options.cookieName!==null){Cookie.write(this.options.cookieName,i,{'domain':CNB.getCookieHost(),'duration':30,'path':location.pathname})}},close:function(i){this.fireEvent('close',i);this.tabs[i].removeClass('on');this.contents[i].addClass(this.options.hiddenClass)}});CNB.Pop=new Class({Extends:CNB.Selector,options:{hiddenClass:'pop-hidden',relativeTo:null,disableTabClick:false,position:{x:'left',y:'bottom'},edge:{x:'left',y:'top'},offset:{x:0,y:0}},initialize:function(b,c,d){this.parent(b,c,d);this.addEvent('open',function(i){this.contents[i].setStyle('visibility','visible');var a=this.contents[i].retrieve('isOpen');if(!a){this.position(i)}this.contents[i].store('isOpen',true)}.bind(this));this.addEvent('close',function(i){this.contents[i].setStyle('visibility','hidden');this.contents[i].store('isOpen',false)}.bind(this))},load:function(){this.tabs.each(function(b,i){if(this.options.disableTabClick){var c=b.getElement('a');c.addEvent('click',function(e){e.stop()})}this.close(i);this.contents[i].setStyles({'position':'absolute'});[b,this.contents[i]].each(function(a){a.addEvent('mouseenter',this.handleMouseEnter.pass(i,this));a.addEvent('mouseleave',this.handleMouseLeave.pass(i,this))},this)},this);return this},handleMouseEnter:function(i){$clear(this.closeDelay);if(i!=this.seq)this.close(this.seq);this.openDelay=this.open.delay(100,this,i)},handleMouseLeave:function(i){$clear(this.openDelay);this.closeDelay=this.close.delay(250,this,i)},position:function(i){var a=this.tabs[i];if($chk(this.options.relativeTo)){a=$(this.options.relativeTo)}this.contents[i].position({relativeTo:a,position:this.options.position,offset:this.options.offset,edge:this.options.edge})}});CNB.Rotocop=new Class({Implements:[Options,Events],options:{itemsPerPage:3,showPrevNext:true,prevNextClass:'',controlsClass:'',showPage:false,slide:true,startPage:1,timer:null,lazyLoad:false},initialize:function(a,b){this.setOptions(b);this.container=$(a);this.contents=this.container.getChildren();this.itemCount=this.contents.length;this.pageCount=Math.ceil(this.itemCount/this.options.itemsPerPage);this.page=this.options.startPage;this.width=this.container.getSize().x;this.cover=new Element('div',{'styles':{'width':this.width,'overflow':'hidden','position':'relative'}});this.controls=new Element('div',{'class':'roto-controls '+this.options.controlsClass})},load:function(){if(this.pageCount==1)return false;this.fireEvent('load',this.contents);this.container.setStyle('width','10000px');this.cover.wraps(this.container);this.controls.inject(this.cover,'after');if(this.options.lazyLoad){new CNB.LazyLoadImg({container:this.cover,mode:'horizontal',range:this.width})}if(this.options.slide){this.fxScroll=new Fx.Scroll(this.cover,{duration:400,transition:Fx.Transitions.Expo.easeOut})}if(this.options.showPrevNext)this.buildPrevNextNav();if(this.options.showPage)this.buildPageNav();if(this.page!=1)this.rotate(this.page);if(this.options.timer)this.setTimer();return this},setTimer:function(){var b=this.next.periodical(this.options.timer,this);var c=[];if(this.options.showPrevNext)c.extend([this.prevBtn,this.nextBtn]);if(this.options.showPage)c.extend(this.pageNav);c.each(function(a){a.addEvent('click',function(){$clear(b)})})},rotate:function(b){var c=this.contents[this.options.itemsPerPage*(b-1)];var d=c.getPosition(this.container).x;if(this.options.slide===true){this.fxScroll.start(d,0)}else{this.cover.scrollTo(d,0)}if(this.options.showPage){this.pageNav[this.page-1].removeClass('on');this.pageNav[b-1].addClass('on')}if(this.options.showPrevNext){[this.prevBtn,this.nextBtn].each(function(a){a.removeClass('disabled')});switch(b){case this.pageCount:this.nextBtn.addClass('disabled');break;case 1:this.prevBtn.addClass('disabled');break}}this.page=b;this.fireEvent('rotate',b)},buildPrevNextNav:function(){var a=new Element('div',{'class':'prev-next '+this.options.prevNextClass});this.prevBtn=new Element('a',{'class':'btn prev disabled','html':'Previous','events':{'click':this.prev.bind(this)}}).inject(a,'bottom');this.nextBtn=new Element('a',{'class':'btn next','html':'Next','events':{'click':this.next.bind(this)}}).inject(a,'bottom');a.inject(this.controls,'bottom')},buildPageNav:function(){this.pageNav=[];var b=new Element('ul',{'class':'roto-pagination clear'});for(i=0;i<this.pageCount;i++){this.pageNav[i]=new Element('li',{'html':'<a>'+(i+1)+'</a>'}).inject(b,'bottom')}this.pageNav[0].addClass('on');this.pageNav.each(function(a,i){a.addEvent('click',this.rotate.pass(i+1,this))},this);b.inject(this.controls,'bottom')},prev:function(){var a=(this.page==1)?this.pageCount:this.page-1;this.rotate(a);this.fireEvent('prev')},next:function(){var a=(this.page==this.pageCount)?1:this.page+1;this.rotate(a);this.fireEvent('next')}});CNB.TagsMore=new Class({Implements:Options,options:{visibleCount:10,textMore:'more&nbsp;+',textLess:'less&nbsp;+'},initialize:function(c,d){this.setOptions(d);$splat(c).each(function(a){var b=a.get('html').clean().split(',');if(b.length>this.options.visibleCount)this.build(a,b)},this)},build:function(a,b){var c=b.splice(this.options.visibleCount,b.length-this.options.visibleCount);var d=new Element('span',{'class':'tags-more','html':c.join(', ')});var e=new Element('a',{'class':'more','html':this.options.textMore});e.addEvent('click',this.toggle.pass([d,e],this));var f=new Element('div',{'html':b.join(', ')+', '}).adopt(d).appendText(' ').adopt(e);a.empty().adopt(f);this.hide(d,e)},toggle:function(a,b){if(a.retrieve('isVisible')){this.hide(a,b)}else{this.show(a,b)}},show:function(a,b){a.store('isVisible',true).setStyle('display','inline');b.set('html',this.options.textLess)},hide:function(a,b){a.store('isVisible',false).setStyle('display','none');b.set('html',this.options.textMore)}});CNB.Expander=new Class({Implements:[Options,Events],options:{content:null,action:'click',hidden:'true',btn:null,btnClass:'',btnText:{show:'Show',hide:'Hide'}},initialize:function(a,b){this.setOptions(b);this.container=$(a);if($chk(this.options.btn)){this.btn=$(this.options.btn)}else{var c=new Element('div',{'class':'more '+this.options.btnClass});this.btn=new Element('a',{'text':this.options.btnText.show}).inject(c);c.inject(this.container,'after')}this.slide=new Fx.Slide(this.container,{'mode':'vertical'}).hide();this.visible=false;this.btn.addEvent(this.options.action,this.toggle.bind(this));if($chk(this.options.btnText.show)){this.addEvents({'show':this.setText.bind(this,this.options.btnText.hide),'hide':this.setText.bind(this,this.options.btnText.show)})}},toggle:function(){if(this.visible){this.hide()}else{this.show()}},setText:function(t){var a=($chk(t))?t:(this.visible)?this.options.btnText.hide:this.options.btnText.show;this.btn.set('html',a)},show:function(){this.visible=true;this.slide.slideIn();this.fireEvent('show',[this.container,this.btn])},hide:function(){this.visible=false;this.slide.slideOut();this.fireEvent('hide',[this.container,this.btn])}});CNB.ExcerptContent=new Class({Implements:Options,options:{limit:200,containerElement:'p',textMore:'Read More&nbsp;+',textLess:'Show Less&nbsp;-',suffix:'...'},initialize:function(a,b){this.setOptions(b);this.container=$(a);if(!this.container){return false}this.content=a.get('text').clean();if(this.content.length>this.options.limit){this.build();this.hide()}},build:function(){this.excerptContainer=new Element(this.options.containerElement,{'class':'content-show-more','html':this.getExcerpt(this.content)+' '});this.moreBtn=new Element('a',{'class':'btn-more more','html':this.options.textMore}).addEvent('click',this.show.bind(this)).inject(this.excerptContainer,'bottom');this.lessBtn=new Element('a',{'class':'btn-less more','html':this.options.textLess}).addEvent('click',this.hide.bind(this)).inject(this.container,'bottom');this.excerptContainer.inject(this.container,'before')},getExcerpt:function(a){var b=a.split('');if(b.length>this.options.limit){for(i=b.length-1;i>-1;i--){if(i>this.options.limit){b.length=i}else if(' '===b[i]){b.length=i;break}}b.push(this.options.suffix)}return b.join('')},show:function(){this.excerptContainer.setStyle('display','none');this.container.setStyle('display','block')},hide:function(a,b){this.excerptContainer.setStyle('display','block');this.container.setStyle('display','none')}});CNB.Placeholder=new Class({initialize:function(a){var b=$splat(a);if(b.length>0){this.set(b)}},addPlaceholder:function(a){var b=a.getProperty('placeholder');if(!$chk(a.value)||(a.value==b)){a.addClass('placeholder');a.value=b}},removePlaceholder:function(a){if(a.hasClass('placeholder')){a.value='';a.removeClass('placeholder')}},set:function(b){b.each(function(a){try{a.store('placeholder',this);a.addEvents({'focus':this.removePlaceholder.pass(a),'blur':this.addPlaceholder.pass(a)});this.addPlaceholder(a)}catch(e){CNB.log('placeholder error:',e)}},this)}});CNB.Validator=new Class({Implements:[Options,Events],options:{onValidateSuccess:function(a,b){},onValidateFailure:function(a,b){a.stop()},validateOnBlur:true,scrollToErrors:false},initialize:function(d,e){this.setOptions(e);this.form=$(d);this.rules={'required':{'type':'field','msg':'This field is required','test':function(a){if(['select','select-one'].contains(a.get('type'))){return(a.selectedIndex>=0&&a.options[a.selectedIndex].value!=='')}else if(['checkbox','radio'].contains(a.get('type'))){return a.get('checked')}else{return((a.get('value')!==null)&&(a.get('value').length!==0))}}},'one-required':{'type':'group','msg':'One of these fields is required','test':function(b){var c=b.getParent('.validate-group')||b.getParent();return c.getElements('input').some(function(a){if(['checkbox','radio'].contains(a.get('type'))){return a.get('checked')}})}},'validate-minlength':{'type':'field','msg':function(a){return'This field must be at least '+a.getProperty('minlength')+' characters'},'test':function(a){return(a.get('value').length>=a.getProperty('minlength'))}},'validate-maxlength':{'type':'field','msg':function(a){return'This field must be no more than least '+a.getProperty('maxlength')+' characters'},'test':function(a){return(a.get('value').length<=a.getProperty('maxlength'))}},'validate-email':{'type':'field','msg':'Please enter a valid email.','test':function(a){return(a.get('value').test(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i))}},'validate-match':{'type':'field','msg':function(a){return'This field must match the '+$(a.getProperty('matchid')).getProperty('name')+' field'},'test':function(a){return($(a.getProperty('matchid')).get('value')==a.get('value'))}},'validate-specialchars':{'type':'field','msg':'Special characters are not allowed in this field','test':function(a){return!(a.get('value').test(/[%;]/))}},'validate-zipdcode-us':{'type':'field','msg':'Please enter a valid postal code','test':function(a){return a.get('value').test(/^[0-9]+$/)}},'validate-no-url':{'type':'field','msg':'A url is not allowed in this field','test':function(a){return!(a.get('value').test('http://','i'))}}};this.errors=new Hash();this.errorsGlobal=[];this.form.store('validator',this);this.form.addEvent('submit',this.validateFields.bind(this));if(this.options.validateOnBlur){this.getFields(true).each(function(a){a.addEvent('blur',this.removeError.pass(a,this));a.addEvent('blur',this.testField.bindWithEvent(this,a))},this)}},getRule:function(a){if(typeof this.rules[a]!='undefined'){return this.rules[a]}else{return false}},addRules:function(a){$each(a,function(v,k){this.rules[k]=v},this)},getFields:function(b){return this.form.getElements('input, select, textarea').filter(function(a){if(a.disabled||a.type=='submit'||a.type=='reset'&&a.type=='file'){return false}if(b){if(a.type=='checkbox'||a.type=='radio'){return false}}return true},this)},testField:function(d,e){e.className.split(' ').each(function(a){var b=this.getRule(a);if(b!==false){if(d.type=='blur'&&b.type=='group')return;if(!b.test(e)){var c=(typeof b.msg=='function')?b.msg(e):b.msg;this.addError(e,c,b.type)}}},this)},validateFields:function(b){this.errors.each(this.removeError,this);this.errorsGlobal.each(function(a){a.destroy()});this.getFields().each(function(a){this.testField(b,a)},this);if(this.errors.getLength()===0){this.fireEvent('validateSuccess',[b,this.form])}else{this.fireEvent('validateFailure',[b,this.form]);if(this.options.scrollToErrors){this.scrollToErrors()}}},scrollToErrors:function(){var i=0;this.errors.each(function(a,b){if(i===0){var c=new Fx.Scroll(window).toElement(a.getParent())}i++},this)},removeError:function(a){var b=a.retrieve('error');if(b==null)return;b.container.destroy();a.removeClass('error-input').eliminate('error');this.errors.erase(a.getProperty('name'))},addError:function(a,b,c){if(a.retrieve('error')!=null)return;var d;if(c=='group'){var e=a.getParent('.validate-group')||a.getParent();d=new Element('div',{'class':'error-lvl','html':b}).inject(e,'top')}else{a.addClass('error-input');d=new Element('div',{'class':'error','html':b}).inject(a,'after')}a.store('error',{'type':'group','container':d});this.errors.set(a.getProperty('name'),a)},addGlobalError:function(a){var b=new Element('div',{'class':'error-lvl','html':a}).inject(this.form,'top');this.errorsGlobal.push(b)}});CNB.Fixated=new Class({Implements:[Options,Events],options:{windowInset:{top:0,bottom:0},addPlaceholder:true,zindex:5,edge:'top',container:null,bottomEl:null,topEl:null},initialize:function(a,b){if(Browser.Engine.trident4||CNB.isTouchDevice){return}this.setOptions(b);this.element=$(a);if(!this.options.container){this.topEl=$(this.options.topEl);this.bottomEl=$(this.options.bottomEl)}else{this.container=$(this.options.container)}var c=this.defaultStyles=this.element.getStyles('top','bottom','width','position','z-index');if(c['z-index']=='auto'){c['z-index']=this.options.zindex;this.element.setStyle('z-index',this.options.zindex)}if(c['top']=='auto'){c['top']=0}c['bottom']=0;this.winSize=window.getSize();this.winScroll=window.getScroll();this.setCoordinates();this.setScrollValues();if(this.options.addPlaceholder){this.addPlaceholder()}window.addEvents({'scroll':this.handleScroll.bind(this),'resize':this.handleResize.bind(this)});this.addEvent('stateChange',this.setPosition.bind(this));this.addEvent('stateChange',this.setClassName.bind(this));this.setStateFromScroll()},setState:function(a){if(!this.state)this.state='default';if(a==this.state){return}this.fireEvent('stateChange',[a,this.state]);this.state=a},setStateFromScroll:function(){var a=this.winScroll.y;var b=this.elCoords.height+this.options.windowInset.top+this.options.windowInset.bottom;var c=this.elCoords.height+this.defaultStyles.top.toInt();var d=this.bottomPos-this.topPos-this.elCoords.height;if(b>this.winSize.y){this.setState('default')}else if(c>d){this.setState('default')}else if(a<this.scrollMin){this.setState('top')}else if(a>this.scrollMax){this.setState('bottom')}else if(a>=this.scrollMin&&a<=this.scrollMax){this.setState('fixed')}},setPosition:function(a){var b=this.bottomPos-this.topPos-this.options.windowInset.bottom,btm,top;switch(a){case'default':this.element.setStyles(this.defaultStyles);break;case'top':this.element.setStyles({'position':'absolute','top':this.defaultStyles.top,'bottom':'auto'});break;case'bottom':switch(this.options.edge){case'top':top=b-this.elCoords.height;btm='auto';break;case'bottom':top='auto';btm=this.defaultStyles.bottom;break}this.element.setStyles({'position':'absolute','top':top,'bottom':btm});break;case'fixed':switch(this.options.edge){case'top':top=this.options.windowInset.top;btm='auto';break;case'bottom':top='auto';btm=this.options.windowInset.bottom;break}this.element.setStyles({'position':'fixed','top':top,'bottom':btm});break}},setClassName:function(a,b){var c='pos-'+a;var d='pos-'+b;this.element.removeClass(d).addClass(c)},handleScroll:function(){this.winScroll=window.getScroll();this.throttle('_throttleScroll',[this.setCoordinates.bind(this),this.setScrollValues.bind(this)]);this.setStateFromScroll()},handleResize:function(){this.winSize=window.getSize();this.throttle('_throttleResize',[this.setCoordinates.bind(this)]);this.setStateFromScroll()},throttle:function(b,c){if(!this[b])this[b]={};if(this[b].isWaiting)return false;$splat(c).each(function(a){a()});var d=function(){this[b].isWaiting=false};this[b].cancel=d.delay(500,this);this[b].isWaiting=true},setCoordinates:function(){this.elCoords=this.element.getCoordinates();if(this.container){this.contCoords=this.container.getCoordinates();this.bottomPos=this.contCoords.bottom;this.topPos=this.contCoords.top}else{if(!this.bottomEl){this.bottomPos=window.getScrollSize().y}else{this.bottomPos=this.bottomEl.getPosition().y}if(!this.topEl||this.options.edge=='bottom'){this.topPos=0}else{this.topPos=this.topEl.getCoordinates().bottom}}},setScrollValues:function(){if(this.options.edge=='bottom'){this.scrollMax=this.bottomPos-this.winSize.y-this.options.windowInset.bottom-this.options.windowInset.top;this.scrollMin=this.topPos+this.defaultStyles.top.toInt()-this.options.windowInset.top}else{this.scrollMax=this.bottomPos-this.elCoords.height-this.options.windowInset.bottom-this.options.windowInset.top;this.scrollMin=this.topPos+this.defaultStyles.top.toInt()-this.options.windowInset.top}},addPlaceholder:function(){var c=new Element('div',{styles:$merge(this.defaultStyles,{'width':'100%'})}).inject(this.element,'before');this.addEvent('stateChange',function(a,b){if(a=='default'){c.setStyle('height',0)}else{c.setStyle('height',this.elCoords.height)}}.bind(this))}});CNB.loadCbsSitesLink=function(b){b=$(b);if(!b)return false;window.rubicsResponse=function(a){b.set('html',a.rubics.response.bodyText).addClass('cbs-sites-promo')};var c=CNB.Page.get('siteId')||'2';var s=document.createElement('script');s.type='text/javascript';s.async=true;s.src='http://rok.com.com/rok-get?app_handle=cncnetworkbar&unit_sp=64&site='+encodeURIComponent(c)+'&wrapper=json';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(s)};CNB.FocusHighlight=new Class({Implements:[Options,Events],options:{opacity:0.5,fadeDuration:1000,hideOnStart:true,speed:'slow'},initialize:function(a,b){this.setOptions(b);this._isPaused=false;this._isMouseEntered=false;var v=Browser.Engine.version;if(Browser.Engine.trident&&(v==6||v==5||v==4)){return}this.element=$(a);this.fade=new Fx.Tween(this.element,{property:'opacity',transition:'linear'});this.element.addEvents({mouseenter:this.handleMouseEnter.bind(this),mouseleave:this.handleMouseLeave.bind(this)});if(this.options.hideOnStart){this.hide()}},isMouseEntered:function(){return this._isMouseEntered},pause:function(){this._isPaused=true},resume:function(){this._isPaused=false;if(this._isMouseEntered){this.show()}else{this.hide(this.options.speed)}},handleMouseEnter:function(){this._isMouseEntered=true;if(!this._isPaused){this.show()}},handleMouseLeave:function(){this._isMouseEntered=false;if(!this._isPaused){this.hide(this.options.speed)}},show:function(){this.fade.cancel();this.element.setStyle('opacity','1');this.fireEvent('show')},hide:function(a){switch(a){case'slow':this.fade.setOptions({duration:2000});this.fade.start('1',this.options.opacity);break;case'fast':this.fade.setOptions({duration:1000});this.fade.start('1',this.options.opacity);break;default:this.element.set('opacity',this.options.opacity)}this.fireEvent('hide')}});CNB.Notification=new Class({Implements:[Events,Options],options:{transition:'slide',notificationClass:'',cookieName:'site-note'},initialize:function(a,b){this.setOptions(b);this.isEnabled=(Cookie.read(this.options.cookieName)=='0')?false:true;this.container=$(a);if(!this.isEnabled&&this.container){this.container.destroy();return}this.container.addEvents({'click:relay(a.close)':this.handleCloseClick.bind(this),'click:relay(a.remove)':this.handleRemoveClick.bind(this),'click:relay(a.remove-perm)':this.handleRemoveClick.bind(this)})},close:function(a){var b=a.retrieve('close');if(b){$clear(b)}switch(this.options.transition){case'slide':new Fx.Slide(a).slideOut().chain(function(){a.destroy()});break;case'fade':a.fade('out').get('tween').chain(function(){a.destroy()});break;default:a.destroy()}},handleCloseClick:function(e,a){e.stop();var b=a.getParent('.'+this.options.notificationClass);this.close(b)},handleRemoveClick:function(e,a){e.stop();var b=(a.hasClass('remove-perm'))?365:null,elNote=a.getParent('.'+this.options.notificationClass);this.close(elNote);Cookie.write(this.options.cookieName,'0',{'domain':CNB.getCookieHost(),'duration':b});this.isEnabled=false}});CNB.Notification.Overlay=new Class({Extends:CNB.Notification,options:{duration:8000,isSticky:false,position:'bottomRight',containerClass:'',notificationClass:'',internalClass:'',closeClass:'',cookieName:'site-note-over',transition:'fade',offset:{x:20,y:5}},initialize:function(a){this.setOptions(a);var b=this.options.offset,posStyles={'position':'fixed','z-index':5000};switch(this.options.position){case'topRight':posStyles.right=b.x;posStyles.top=b.y;break;case'bottomRight':posStyles.right=b.x;posStyles.bottom=b.y;break;default:posStyles.right=b.x;posStyles.bottom=b.y;break}this.container=new Element('div',{'class':'notification-cont '+this.options.containerClass,'styles':posStyles});window.addEvent('domready',function(){this.container.inject($(document.body))}.bind(this));this.parent(this.container,a)},add:function(a,b){if(!this.isEnabled){return}b=b||{};b=$merge({duration:this.options.duration,isSticky:this.options.isSticky},b);var c=new Element('div',{'class':'notification '+this.options.notificationClass,'html':'<a href="#" class="notification-close close '+this.options.closeClass+'"><span class="int">X</span></a>'+'<div class="int '+this.options.internalClass+'">'+a+'</div>'});var d=new Element('a',{'class':'','html':''}).addEvent('click',this.close.bind(this,c));if(!b.isSticky){var e=this.close.delay(b.duration,this,c);c.store('close',e)}c.store('options',b);c.addEvents({'mouseenter':this.handleEnterEvent.bind(this,c),'mouseleave':this.handleLeaveEvent.bind(this,c)});c.fade('hide');c.inject(this.container,'bottom');c.fade('in')},clear:function(){if(!this.isEnabled){return}this.container.getElements('.'+this.options.notificationClass).each(function(a){this.close(a)},this)},replace:function(a,b){if(!this.isEnabled){return}this.clear();this.add(a,b)},handleRemoveClick:function(e,a){e.stop();var b=(a.hasClass('remove-perm'))?365:null;this.clear();this.container.destroy();Cookie.write(this.options.cookieName,'0',{'domain':CNB.getCookieHost(),'duration':b});this.isEnabled=false},handleEnterEvent:function(a){var b=a.retrieve('close');if(b){$clear(b);a.eliminate('close')}},handleLeaveEvent:function(a){var b=a.retrieve('options')||{};if(!b.isSticky){var c=this.close.delay(Math.floor(b.duration/3),this,a);a.store('close',c)}}});CNB.PopSelect=new Class({Extends:CNB.Pop,options:{setSelectionOnClick:true,setMinWidth:true,cookieName:null,setCookieOnClick:false,activeClass:'on',selectionClass:'selection'},initialize:function(a,b,c){this.parent(a,b,c);this.addEvent('open',function(i){if(this.options.setMinWidth){this.setMinWidth()}}.bind(this));var d=this.tabs[0].getStyle('width');this.tabs[0].setStyle('min-width',Math.ceil(d));this.contents[0].addEvent('click:relay(a)',this.handleClickEvent.bind(this));var e=this.contents[0].getElement('a.'+this.options.activeClass);if(e){this.setSelection(e)}},handleClickEvent:function(e,a){if(this.options.setSelectionOnClick){this.setSelection(a);if(this.options.setMinWidth){this.setMinWidth()}}if(this.options.setCookieOnClick){this.handleCookieSet(a)}this.fireEvent('selection',[e,a])},setSelection:function(a){var b=a.getElement('.value');if(!b)b=a;var c=b.get('text');this.tabs[0].getElement('.'+this.options.selectionClass).set('text',c);var d=this.contents[0].getElement('a.'+this.options.activeClass);if(d)d.removeClass(this.options.activeClass);a.addClass(this.options.activeClass);this.close(0)},setMinWidth:function(){var a=this.tabs[0].getStyle('width');this.contents[0].setStyle('min-width',a)},handleCookieSet:function(a){var b=this.tabs[0].getProperty('data-cookie-name');var c=JSON.decode(a.getProperty('data-cookie-value'));if(b&&c){var d=JSON.decode(Cookie.read(b));var e=($type(d)=='object')?$merge(d,c):c;Cookie.write(b,JSON.encode(e),{domain:CNB.getCookieHost(),path:'/'})}}});CNB.PopSelect.MultiInit=function(c,d,e){c.each(function(a,i){var b=new CNB.PopSelect(a,d[i],e).load()})};CNB.LazyLoadImg=new Class({Implements:[Options,Events],options:{range:200,elements:'img',container:window,mode:'vertical',realSrcAttribute:'data-src',useFade:true},initialize:function(b){this.setOptions(b);this.container=document.id(this.options.container);this.elements=document.id(this.container==window?document.body:this.container).getElements(this.options.elements);if(this.options.useFade){this.elements.each(function(a){a.setStyle('opacity',0)})}this.posScrollPeak=0;this.axis=(this.options.mode=='vertical'?'y':'x');this.offset=(this.container!=window&&this.container!=document.body?this.container:'');this.loadImages(1);this.fnStoreScroll=function(){this.throttle('_throttleSroll',[this.handleScroll.bind(this)])}.bind(this);this.container.addEvent('scroll',this.fnStoreScroll)},throttle:function(b,c){if(!this[b])this[b]={};if(this[b].isWaiting){return false}$splat(c).each(function(a){a()});var d=function(){this[b].isWaiting=false};this[b].cancel=d.delay(150,this);this[b].isWaiting=true},loadImages:function(){var c=this.container.getScroll()[this.axis];if(c<this.posScrollPeak){return}this.posScrollPeak=c;this.elements=this.elements.filter(function(a){if(this.options.useFade){a.setStyle('opacity',0)}var b=a.getPosition(this.offset)[this.axis],sizeCont=this.container.getSize()[this.axis];if((c+this.options.range+sizeCont)>=b){this.loadImage(a);return false}return true},this)},loadImage:function(a){if(this.options.useFade){a.addEvent('load',function(){a.fade(1)})}a.set('src',a.get(this.options.realSrcAttribute));this.fireEvent('load',[a])},handleScroll:function(){this.loadImages();this.fireEvent('scroll');if(!this.elements.length){this.container.removeEvent('scroll',this.fnStoreScroll);this.fireEvent("complete")}}});(function(){var c=CNB.Page.get('adRefreshDelay')||1000,isRefreshPaused=false,methods={handleSkinEmbed:function(b){window.addEvent('domready',function(){var a=Elements.from('<div class="skinClick"></div><div class="skinClick"></div>');b.adopt(a);CNB.clickableSkin.load(a,'content','mantle_skin')})}};CNB.mantaRay={refreshAds:function(a){if(isRefreshPaused){return}a=$splat(a);cbsiGetDeferredAds(a,this.callbacks);isRefreshPaused=true;(function(){isRefreshPaused=false}).delay(c)},callbacks:{onembed:function(a){if(a===undefined||!a||a.isBlank=='1'){return}var b=$(a.divId);b.addClass('active');if(a.divId==='cbsiAd119_100'){methods.handleSkinEmbed(b)}},onload:function(a){}}}})();window.addEvent('domready',function(){var c=new CNB.Placeholder($$('input[placeholder]'));$(document.body).addEvent('click:relay(a)',function(e,a){var b=a.getProperty('href');if(b===null)return false;if(b.trim().indexOf('#')===0){e.stop();CNB.scrollTo(b.substr(1))}})});