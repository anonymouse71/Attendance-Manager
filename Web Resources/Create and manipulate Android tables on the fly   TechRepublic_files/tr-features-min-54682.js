(function(){String.implement({getHostname:function(){var re=new RegExp('^(?:f|ht)tp(?:s)?\://([^/]+)','im');return this.match(re)[1].toString()}});CNB.TR={};CNB.initNavOverlay=function(){try{var container=$('header-sec');var tabs=container.getElements('.nav-sec li');var overlay=container.getElements('.overlay-pop');var pop=new CNB.Pop(tabs,overlay,{offset:{x:0,y:-2}}).load();var container2=$('member-tools');var tabs=container2.getElements('.my-profile');var overlay=container2.getElements('.overlay-pop');var pop=new CNB.Pop(tabs,overlay,{offset:{x:0,y:-2}}).load()}catch(err){}};CNB.TR.LandingPad=new Class({initialize:function(){this.state=Cookie.read('landing-pad');this.container=$('landing');this.btn=this.container.getElements('.landing-collapse');this.content=this.container.getElements('.landing-pad')},load:function(){if(this.state=='collapsed'){this.hide()}else{this.btn.set('text','Collapse -')}this.btn.addEvent('click',this.toggle.bind(this))},toggle:function(){if(this.state=='collapsed'){this.show()}else{this.hide()}},show:function(){this.state='expanded';this.content.setStyle('display','block');this.setCookie(this.state);this.btn.set('text','Collapse -')},hide:function(){this.state='collapsed';this.content.setStyle('display','none');this.setCookie(this.state);this.btn.set('text','Expand +')},setCookie:function(state){Cookie.write('landing-pad',state,{duration:30,domain:CNB.getCookieHost(),path:'/'})}});CNB.clickableSkin={load:function(clickables,content,container){this.elements=$$(clickables);this.container=$(container);this.content=$(content);if(!$chk(this.elements)||!$chk(this.container)||!$chk(this.content))return false;this.container.setStyle('position','relative');this.setClickableArea();window.addEvent('resize',this.setClickableArea.bind(this))},setClickableArea:function(){var containerSize=this.container.getScrollSize();var contentSize=this.content.getSize();var gutterSize=containerSize.x-contentSize.x;var width=(gutterSize>0)?Math.floor(gutterSize/2):0;var height=containerSize.y;if(width>0&&height>0){this.elements.each(function(el,i){el.setStyles({'position':'absolute','z-index':'1','top':'0','left':0,'width':width,'height':height});if(i==1){el.setStyles({'left':'auto','right':'0'})}})}}};CNB.Overlay.loadEmail=function(options){var handleFormSubmit=function(e,form){e.stop();overlay.loader.add();var request=new Request.JSON({url:form.getProperty('action'),data:form.toJSON(),onSuccess:function(data){if(data.status=='success'){overlay.notify('Your message has been sent.')}else{overlay.notify('Sorry we can\'t send your message at this time.')}},onComplete:overlay.loader.remove.bind(overlay.loader),onFailure:function(xhr){overlay.notify('Sorry we can\'t send your message at this time.')}}).post()};var overlay=new CNB.Overlay.Async(options);overlay.addOneEvent('contentReady',function(content){var validate=new CNB.Validator(content.getElement('form'),{onValidateSuccess:handleFormSubmit})});overlay.open()};CNB.SubscribePromo=new Class({initialize:function(loggedInForm,loggedOutForm){this.loggedOutForm=$(loggedOutForm);this.loggedInForm=$(loggedInForm);this.loader=new CNB.Loading(this.loggedInForm);this.loggedOutForm.addEvent('submit',this.loggedOutSubmit.bind(this));this.validate=new CNB.Validator(this.loggedInForm,{onValidateSuccess:CNB.Reg.checkLoggedIn.bindWithEvent(CNB.Reg,this.loggedInSubmit.bind(this))})},loggedOutSubmit:function(e){e.stop();CNB.Reg.join({'data':this.loggedOutForm.toJSON()})},loggedInSubmit:function(){this.loader.add();var request=new Request.JSON({url:this.loggedInForm.getProperty('action'),data:$merge(this.loggedInForm.toJSON(),{'appId':'243','updateUser':true}),onSuccess:this.subscribeResponse.bind(this),onComplete:this.loader.remove.bind(this.loader),onFailure:function(xhr){this.subscribeResponse({'status':'failure'})}}).post()},subscribeResponse:function(response){switch(response.status){case'success':msg='Thank you for subscribing.';break;default:msg='Sorry, we encountered a problem, and can\'t process your request at this time.'}this.loggedInForm.empty().set('html','<p class="heavy c-6">'+msg+'</p>')}});CNB.RegOverlay=new Class({initialize:function(){this.isUser=(Cookie.read('purs_3')!=null)?true:false;this.hasViewed=(Cookie.read('reg-overlay')!=null)?true:false},load:function(){if(this.isUser||this.hasViewed){return false}var path=location.pathname;var host=location.hostname;if(path.contains('/members/')){return false}if(CNB.Page&&CNB.Page.isIntroScheduled===true){return false}if(!CNB.hasCookiesEnabled()){return false}this.overlay=new CNB.Overlay({id:'reg-pop-overlay',containerClass:'contain-overlay-14',content:this.buildContent(),onClose:function(){DW.redir({'ctype':'reg-ol;act','cval':'close'})},onOpen:function(){DW.redir({ctype:'reg-ol;act',cval:'load'});Cookie.write('reg-overlay','1',{duration:30,domain:CNB.getCookieHost(),path:'/'})}}).open()},buildContent:function(){var hed='<div class="hed hed-2"><h6 class="h s-7 s-2">Join the largest community of IT leaders on the Web</h6></div>';var output=new Element('div',{'html':hed});var html='<h4 class="h s-9 heavy">TechRepublic members receive FREE access to:</h4>'+'<div class="view-4 pad-1 space-1"><ul class="list-1"><li>10,000+ field-tested how-to&#8217;s from in-the-trenches IT pros</li>'+'<li>50,000+ white papers, containing critical decision-support resources for IT managers and CIOs</li>'+'<li>1,200+ downloads featuring powerful tools to simplify IT operations</li>'+'<li>130,000+ technical Q&A and discussions from a highly engaged community of IT leaders</li>'+'</ul><p>More than 20 newsletters, covering a wide-array of IT topics</p></div>';var contents=new Element('div',{'class':'content view-2 pad-1_5-a','html':html}).inject(output);var submitLevel=new Element('div',{'class':'lvl-btn clear space-1'}).inject(contents,'bottom');var join=new Element('a',{'class':'btn btn-1 s-9','text':'Sign Me Up','events':{'click':function(){DW.redir({ctype:'reg-ol;act',cval:'signmeup'});this.overlay.remove();CNB.Reg.join({regSrc:'reg-over'})}.bind(this)}}).inject(submitLevel,'top');var span=new Element('span',{'class':'other-options right-1 s-11 sink-0_3','html':' &nbsp;|&nbsp; '}).inject(submitLevel,'bottom');var noThanks=new Element('a',{'text':'No thanks','class':'close','events':{'click':function(){this.overlay.removeEvents('close');DW.redir({ctype:'reg-ol;act',cval:'nothanks'})}.bind(this)}}).inject(span,'top');var login=new Element('a',{'html':'I&#8217;m already a member','events':{'click':function(){DW.redir({ctype:'reg-ol;act',cval:'currentmember'});this.overlay.remove();if(typeof CNB.Reg.logIn!='undefined'){CNB.Reg.logIn({regSource:'reg-over'})}else{CNB.Reg.login({regSrc:'reg-over'})}}.bind(this)}}).inject(span,'bottom');return output}});CNB.Overlay.loadEmail=function(options){var handleFormSubmit=function(e,form){e.stop();overlay.loader.add();var request=new Request.JSON({url:form.getProperty('action'),data:form.toJSON(),onSuccess:function(data){if(data.status=='success'){overlay.notify('Your message has been sent.')}else{overlay.notify('Sorry we can\'t send your message at this time.')}},onComplete:overlay.loader.remove.bind(overlay.loader),onFailure:function(xhr){overlay.notify('Sorry we can\'t send your message at this time.')}}).post()};var overlay=new CNB.Overlay.Async(options);overlay.addOneEvent('contentReady',function(content){var validate=new CNB.Validator(content.getElement('form'),{onValidateSuccess:handleFormSubmit})});overlay.open()};CNB.CharCounter=new Class({Implements:[Options,Events],options:{max:'6000',updateElementId:'chars-left',limitClass:'limit-chars'},initialize:function(input,options){this.setOptions(options);this.input=$(input);this.checkElement();this.input.addEvent('keydown',function(){this.checkElement()}.bind(this))},checkElement:function(){var inputSize=this.input.get('value').length;var charsLeft=this.options.max.toInt()-inputSize;if(inputSize>=this.options.max.toInt()){$(this.options.updateElementId).set('text',0);if(!$(this.options.updateElementId).hasClass(this.options.limitClass)){$(this.options.updateElementId).addClass(this.options.limitClass)}}else{$(this.options.updateElementId).set('text',(charsLeft));if($(this.options.updateElementId).hasClass(this.options.limitClass)){$(this.options.updateElementId).removeClass(this.options.limitClass)}if(charsLeft<=5){$(this.options.updateElementId).addClass(this.options.limitClass)}}}});CNB.TR.SiteAction=new Class({Implements:[Options,Events],options:{url:'',data:{},regSrc:'site-action',storageName:'site-action'},initialize:function(anchor,options){this.anchor=$(anchor);if(!this.anchor)return false;this.setOptions(options);this.data=this.options.data;this.url=this.options.url;this.anchor.store(this.options.storageName,this)},makeRequest:function(){if(this.anchor.retrieve('isActive')){return false}this.anchor.store('isActive',true);this.anchor.addClass('loading');var request=new Request.JSON({url:this.url,data:this.data,onSuccess:function(data){if(typeof data=='undefined'||typeof data.status=='undefined'){CNB.log('json data is no good');return false}this.fireEvent(data.status,data)}.bind(this),onComplete:function(){this.fireEvent('complete');this.anchor.store('isActive',false);this.anchor.removeClass('loading')}.bind(this),onFailure:function(xhr){this.fireEvent('failure')}.bind(this)}).get()},gateRequest:function(){CNB.Reg.gatedEvent(null,this.makeRequest.bind(this),this.options.regSrc,'Please Log In First')}});CNB.TR.Favorite=new Class({Extends:CNB.TR.SiteAction,options:{onSuccess:function(data){this.setDisplay(data)},onFailure:function(){CNB.log('favorite failure')},text:{add:'Favorite',remove:'Favorite'},regSrc:'fav',className:'is-favorite',storageName:'favorite'},initialize:function(e,anchor,options){this.anchor=$(anchor);if(!this.anchor)return false;var objData=JSON.decode(this.anchor.getProperty('data-favorite'));if(objData){options=$merge(options,objData)}this.parent(anchor,options);this.url=(this.options.url)?this.options.url:this.anchor.getProperty('href')},add:function(){this.data.type=this.data.actionType='add';this.gateRequest()},remove:function(){this.data.type=this.data.actionType='remove';this.gateRequest()},toggle:function(e){if(this.anchor.hasClass(this.options.className)){this.remove()}else{this.add()}},setDisplay:function(data){if(this.data.actionType=='remove'){this.anchor.removeClass(this.options.className);this.anchor.set('text',this.options.text.add)}else{this.anchor.addClass(this.options.className);this.anchor.set('text',this.options.text.remove)}cbsiGetDeferredAds(["cbsiAd16_100","cbsiAd16_200"],{onembed:CNB.MantaRayEmbed,onload:CNB.MantaRayLoad})}});CNB.TR.Favorite.toggle=function(e,el){e=new Event(e).stop();var inst=el.retrieve('favorite')||new CNB.TR.Favorite(e,el);inst.toggle()};CNB.TR.Follow=new Class({Extends:CNB.TR.SiteAction,options:{onSuccess:function(data){this.setDisplay(data)},onFailure:function(){CNB.log('Follow failure')},regSrc:'follow',className:'is-contact',text:{add:'Follow',remove:'Unfollow'},storageName:'follow',confirmUnfollow:true},initialize:function(e,anchor,options){this.anchor=$(anchor);if(!this.anchor)return false;var objData=JSON.decode(this.anchor.getProperty('data-follow'));if(objData){options=$merge(options,objData)}this.parent(anchor,options);this.url=(this.options.url)?this.options.url:this.anchor.getProperty('href')},add:function(){this.data.type=this.data.actionType='add';this.gateRequest()},remove:function(){this.data.type=this.data.actionType='remove';this.gateRequest()},toggle:function(){if(this.anchor.hasClass(this.options.className)){if(!this.options.confirmUnfollow){this.remove()}else if(confirm('Are you sure you want to unfollow this contact?')){this.remove()}}else{this.add()}},setDisplay:function(data){if(this.data.actionType=='remove'){this.anchor.removeClass(this.options.className);this.anchor.set('text',this.options.text.add)}else{this.anchor.addClass(this.options.className);this.anchor.set('text',this.options.text.remove)}}});CNB.TR.Follow.toggle=function(e,el){e=new Event(e).stop();var inst=el.retrieve('follow')||new CNB.TR.Follow(e,el,{storageName:'follow'});inst.toggle()};CNB.MantaRayLoad=function(adObj){if($type(adObj)=='undefined'){return false};var adLoad=new CNB.TR.MantaRay(adObj,{action:'load'})};CNB.MantaRayEmbed=function(adObj){if($type(adObj)=='undefined'){return false};var adEmbed=new CNB.TR.MantaRay(adObj,{action:'embed'})};CNB.TR.MantaRay=new Class({Implements:[Options,Events],options:{action:'load'},initialize:function(adObj,options){this.setOptions(options);if($type(adObj)=='undefined'){return false};if($type(adObj)=='array'){adObj.each(function(ad,i){this.initAdAction(ad)}.bind(this))}else{this.initAdAction(adObj)}},initAdAction:function(ad){this.ad=ad;this.adScheduled=(ad.isBlank=='1')?false:true;this.adContainer=ad.divId;this.action=this.options.action;if(this.adScheduled){this.adHolder=$(this.adContainer).getFirst('div.adHolder');this.adFrame=this.adHolder.getElement('iframe');if(this.adFrame.getStyle('height')=='0px'||this.adFrame.getStyle('height')=='0'){this.isAdFrameAvailable=false}else{this.isAdFrameAvailable=true}switch(this.adContainer){case'cbsiAd16_100':this.handleTopMpu();break;case'cbsiAd16_200':this.handleLowerMpu();break;case'cbsiAd119_100':this.handleSkin();break;case'cbsiAd248_100':this.handleLeader();break;case'cbsiAd15_500':this.handleLeader();break;case'cbsiAd173_100':this.handleTextLink();break;case'cbsiAd102_300':this.handleVtu3();break;default:break}}},handleVtu3:function(){this.adFrame.setStyle('width',300)},handleTextLink:function(){this.adFrame.setStyle('width',300)},handleLeader:function(){if(this.action=='load'){$(this.adContainer).removeProperty('style');var adSize=this.adFrame.getSize();if(adSize.x==0){adSize=(this.adHolder.getFirst('table'))?this.adHolder.getFirst('table').getSize():this.adHolder.getFirst('div').getSize();if(typeof adSize=='undefined'||(typeof adSize!='undefined'&&adSize.x==0)){CNB.log('No leaderAd width found');this.adHolder.setStyle('display','inline-block');$(this.adContainer).setStyles({'text-align':'center','margin':'0 auto'});return false}}$(this.adContainer).setStyles({'width':adSize.x,'text-align':'center','margin':'0 auto'});if(!this.isAdFrameAvailable){$(this.adContainer).setStyle('padding','10px 0')}}},handleSkin:function(){if(this.action=='embed'){var skinDiv=new Element('div',{'class':'skinClick'});skinDiv.inject($(this.adContainer),'after');skinDiv.clone().inject($(this.adContainer),'after')}else{var clickableAreas=$$('.skinClick');if($chk(clickableAreas)){CNB.clickableSkin.load(clickableAreas,'content','mantle_skin')}}},handleTopMpu:function(){if(!this.isAdFrameAvailable){if(!this.adHolder.hasClass('space-2')){this.adHolder.addClass('space-2')}}else{if(!this.adHolder.hasClass('space-2')){this.adHolder.removeClass('space-2')}}},handleLowerMpu:function(){if(!this.isAdFrameAvailable){if(!this.adHolder.hasClass('space-2')){this.adHolder.addClass('space-2')}}else{if(!this.adHolder.hasClass('space-2')){this.adHolder.removeClass('space-2')}}}});if(CNB.Voting){CNB.TR.Voting=new Class({Extends:CNB.Voting,options:{onSuccess:function(data){var suffix=(data.voteCount==1)?'Vote':'Votes';var updatedCount=parseInt(this.options.voteCount)+parseInt(data.cr);this.container.getElement('.count').set('text',updatedCount);this.container.getElement('.suffix').set('text',suffix);this.container.getElement('.status').addClass('on')},onClick:function(container){this.loader=new CNB.Loading(container.getElement('.status'))}},initialize:function(container,options){this.parent(container,options)}})}CNB.PopToolTip=new Class({Implements:[Options,Events],options:{storeName:'pop-tooltip',url:'',data:{},containerClass:'contain-overlay-10'},initialize:function(el,options){this.elTarget=$(el);var objData=JSON.decode(this.elTarget.getProperty('data-pop-tooltip'));if(objData){options=$merge(options,objData)}this.setOptions(options);if(!this.elTarget)return false;this.elTarget.store(this.options.storeName,this);this.elContent=new Element('div',{'class':'pop-tt '+this.options.containerClass,'html':'<div class="loading"></div><div class="arrow"></div>'});this.pop=new CNB.Pop(this.elTarget,this.elContent,{offset:{x:-8,y:-4},position:{x:'right',y:'top'}}).load();this.request=new Request.JSON({url:this.options.url,data:this.options.data,onSuccess:this.handleRequestResponse.bind(this),onFailure:this.handleRequestResponse.bind(this,{success:'failure'}),noCache:true}).get();this.elContent.inject(this.elTarget,'after')},open:function(){this.pop.open(0)},close:function(){this.pop.close(0)},handleRequestResponse:function(data){this.elContent.getElement('.loading').destroy();if(data&&data.status=='success'){this.elContent.adopt(CNB.htmlToElement(data.html))}else{this.elContent.set('html','<p>Doh! I just bonked.</p>')}}});CNB.PopToolTip.mngr={cache:{},current:null,get:function(el,name){return el.retrieve(name)||new CNB.PopToolTip(el,{storeName:name})},open:function(el,name){if(this.current){this.current.close()}var inst=this.get(el,name);inst.open();this.current=inst},initDelegation:function(name){var openDelay;$(document.body).addEvents({'mouseover:relay(span.pop-tt-trgt)':function(e,el){openDelay=this.open.delay(100,this,[el,name])}.bind(this),'mouseout:relay(span.pop-tt-trgt)':function(e,el){$clear(openDelay)}})}};CNB.TR.siteLink=function(e,el){var url=el.getProperty('sitelink');var isValid=function(url){var host=url.getHostname();if(host=='www.techrepublic.com'||host.contains('c13-b2b-fa-ww1.cnet.com:')||host.contains('dev.techrepublic.com:')||host=='www.irisuat.techrepublic.com'||host=='www.irisdev.techrepublic.com'||host=='www.irisqa.techrepublic.com'){return true}else{return false}return false};if(isValid(url)){e.stop();window.location=url}};window.addEvent('domready',function(){var regOverlay=new CNB.RegOverlay().load();var clickableAreas=$$('.skinClick');if($chk(clickableAreas)){CNB.clickableSkin.load(clickableAreas,'content','mantle_skin')}$(document.body).addEvents({'click:relay(a[siteaction=favorite])':CNB.TR.Favorite.toggle,'click:relay(a[siteaction=follower])':CNB.TR.Follow.toggle,'click:relay(a[sitelink])':CNB.TR.siteLink});CNB.PopToolTip.mngr.initDelegation('user-tooltip')})})();